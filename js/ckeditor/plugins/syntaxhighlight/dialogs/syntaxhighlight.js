CKEDITOR.dialog.add("syntaxhighlight",function(e){var t=e.lang.syntaxhighlight;if(t.title==null)t=e.lang.syntaxhighlight.syntaxhighlight;var n=function(e){e=e.replace(/<br>/g,"\n");e=e.replace(/&/g,"&");e=e.replace(/</g,"<");e=e.replace(/>/g,">");e=e.replace(/"/g,'"');return e};var r=function(e){var e=new Object;e.hideGutter=false;e.hideControls=false;e.collapse=false;e.showColumns=false;e.noWrap=false;e.firstLineChecked=false;e.firstLine=0;e.highlightChecked=false;e.highlight=null;e.lang=null;e.code="";return e};var i=function(e){var t=r();if(e){if(e.indexOf("brush")>-1){var n=/brush:[ ]{0,1}(\w*)/.exec(e);if(n!=null&&n.length>0){t.lang=n[1].replace(/^\s+|\s+$/g,"")}}if(e.indexOf("gutter")>-1){t.hideGutter=true}if(e.indexOf("toolbar")>-1){t.hideControls=true}if(e.indexOf("collapse")>-1){t.collapse=true}if(e.indexOf("first-line")>-1){var n=/first-line:[ ]{0,1}([0-9]{1,4})/.exec(e);if(n!=null&&n.length>0&&n[1]>1){t.firstLineChecked=true;t.firstLine=n[1]}}if(e.indexOf("highlight")>-1){if(e.match(/highlight:[ ]{0,1}\[[0-9]+(,[0-9]+)*\]/)){var i=/highlight:[ ]{0,1}\[(.*)\]/.exec(e);if(i!=null&&i.length>0){t.highlightChecked=true;t.highlight=i[1]}}}if(e.indexOf("ruler")>-1){t.showColumns=true}if(e.indexOf("wrap-lines")>-1){t.noWrap=true}}return t};var s=function(e){var t="brush:"+e.lang+";";if(e.hideGutter){t+="gutter:false;"}if(e.hideControls){t+="toolbar:false;"}if(e.collapse){t+="collapse:true;"}if(e.showColumns){t+="ruler:true;"}if(e.noWrap){t+="wrap-lines:false;"}if(e.firstLineChecked&&e.firstLine>1){t+="first-line:"+e.firstLine+";"}if(e.highlightChecked&&e.highlight!=""){t+="highlight: ["+e.highlight.replace(/\s/gi,"")+"];"}return t};console.log(t);return{title:t.title,minWidth:500,minHeight:400,onShow:function(){var e=this.getParentEditor();var t=e.getSelection();var s=t.getStartElement();var o=s&&s.getAscendant("pre",true);var u="";var f=null;if(o){code=n(o.getHtml());f=i(o.getAttribute("class"));f.code=code}else{f=r()}this.setupContent(f)},onOk:function(){var e=this.getParentEditor();var t=e.getSelection();var n=t.getStartElement();var i=n&&n.getAscendant("pre",true);var o=r();this.commitContent(o);var u=s(o);if(i){i.setAttribute("class",u);i.setText(o.code)}else{var a=new CKEDITOR.dom.element("pre");a.setAttribute("class",u);a.setText(o.code);e.insertElement(a)}},contents:[{id:"source",label:t.sourceTab,accessKey:"S",elements:[{type:"vbox",children:[{id:"cmbLang",type:"select",labelLayout:"horizontal",label:t.langLbl,"default":"php",widths:["25%","75%"],items:[["Bash (Shell)","bash"],["C#","csharp"],["C++","cpp"],["CSS","css"],["Delphi","delphi"],["Diff","diff"],["Groovy","groovy"],["Javascript","jscript"],["Java","java"],["Java FX","javafx"],["Perl","perl"],["PHP","php"],["Plain (Text)","plain"],["Python","python"],["Ruby","ruby"],["Scala","scala"],["SQL","sql"],["VB","vb"],["XML/XHTML","xml"]],setup:function(e){if(e.lang){this.setValue(e.lang)}},commit:function(e){e.lang=this.getValue()}}]},{type:"textarea",id:"hl_code",rows:22,style:"width: 100%",setup:function(e){if(e.code){this.setValue(e.code)}},commit:function(e){e.code=this.getValue()}}]},{id:"advanced",label:t.advancedTab,accessKey:"A",elements:[{type:"vbox",children:[{type:"html",html:"<strong>"+t.hideGutter+"</strong>"},{type:"checkbox",id:"hide_gutter",label:t.hideGutterLbl,setup:function(e){this.setValue(e.hideGutter)},commit:function(e){e.hideGutter=this.getValue()}},{type:"html",html:"<strong>"+t.hideControls+"</strong>"},{type:"checkbox",id:"hide_controls",label:t.hideControlsLbl,setup:function(e){this.setValue(e.hideControls)},commit:function(e){e.hideControls=this.getValue()}},{type:"html",html:"<strong>"+t.collapse+"</strong>"},{type:"checkbox",id:"collapse",label:t.collapseLbl,setup:function(e){this.setValue(e.collapse)},commit:function(e){e.collapse=this.getValue()}},{type:"html",html:"<strong>"+t.showColumns+"</strong>"},{type:"checkbox",id:"show_columns",label:t.showColumnsLbl,setup:function(e){this.setValue(e.showColumns)},commit:function(e){e.showColumns=this.getValue()}},{type:"html",html:"<strong>"+t.lineWrap+"</strong>"},{type:"checkbox",id:"line_wrap",label:t.lineWrapLbl,setup:function(e){this.setValue(e.noWrap)},commit:function(e){e.noWrap=this.getValue()}},{type:"html",html:"<strong>"+t.lineCount+"</strong>"},{type:"hbox",widths:["5%","95%"],children:[{type:"checkbox",id:"lc_toggle",label:"",setup:function(e){this.setValue(e.firstLineChecked)},commit:function(e){e.firstLineChecked=this.getValue()}},{type:"text",id:"default_lc",style:"width: 15%;",label:"",setup:function(e){if(e.firstLine>1){this.setValue(e.firstLine)}},commit:function(e){if(this.getValue()&&this.getValue()!=""){e.firstLine=this.getValue()}}}]},{type:"html",html:"<strong>"+t.highlight+"</strong>"},{type:"hbox",widths:["5%","95%"],children:[{type:"checkbox",id:"hl_toggle",label:"",setup:function(e){this.setValue(e.highlightChecked)},commit:function(e){e.highlightChecked=this.getValue()}},{type:"text",id:"default_hl",style:"width: 40%;",label:"",setup:function(e){if(e.highlight!=null){this.setValue(e.highlight)}},commit:function(e){if(this.getValue()&&this.getValue()!=""){e.highlight=this.getValue()}}}]},{type:"hbox",widths:["5%","95%"],children:[{type:"html",html:""},{type:"html",html:"<i>"+t.highlightLbl+"</i>"}]}]}]}]}})